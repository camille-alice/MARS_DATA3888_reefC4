---
title: "nathan_ida"
author: '490418846'
date: '2022-04-02'
output: html_document
---

```{r}
library(tidyverse)
library(sf)
```

## Storm Data

```{r}
storms_list = read.csv("Data/ibtracs.ALL.list.v04r00.csv")
storms_list = storms_list %>% 
  slice(-1) %>%
  select(SID, SEASON, LAT, LON, STORM_SPEED, STORM_DIR) %>%
  mutate(SEASON = as.numeric(SEASON)) %>%
  filter(SEASON >= 1997) %>%
  mutate(LAT = as.numeric(LAT)) %>%
  mutate(LON = as.numeric(LON)) %>%
  mutate(STORM_SPEED = as.numeric(STORM_SPEED)) %>%
  mutate(STORM_DIR = as.numeric(STORM_DIR)) %>%
  drop_na()
```

## Benthic Map Data

```{r}
benthic = st_read("Data/benthic.gpkg")
geom = lapply(benthic$geom, st_bbox)
bbox_vector = c()
for (i in 1:length(geom)) {
  bbox_vector = rbind(bbox_vector, t(matrix(unlist(geom[[i]]))))
}
benthic = as.data.frame(cbind(benthic$class, bbox_vector))
colnames(benthic) = c("Class", "xmin", "ymin", "xmax", "ymax")
benthic = benthic %>%
  mutate(xmin = as.numeric(xmin)) %>%
  mutate(ymin = as.numeric(ymin)) %>%
  mutate(xmax = as.numeric(xmax)) %>%
  mutate(ymax = as.numeric(ymax))
```

